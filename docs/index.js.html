<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: index.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: index.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import {Controller} from './controller/Controller.js';

const storeApp=new Controller();

// storeApp.addProductToStore('Portatil Acer Travelmate E2100', 523.60);
// storeApp.addProductToStore('Portatil Asus 5704', 679.60);
// storeApp.addProductToStore('Teclado Logitech A456', 43.60);

// storeApp.deleteProductFromStore(1);

// storeApp.changeProductStock(3,2);

// storeApp.changeProductStock(2,1);

// storeApp.deleteProductFromStore(10);

// storeApp.changeProductInStore(3,"Raton",14,4);

/**
 * Inicializa la aplicación, carga los productos desde el servidor y gestiona los eventos del formulario así como las
   acciones de añadir, editar, borrar y modificar stock.
 */
async function init(){
  let form=document.getElementById('newprod');
    let table=document.getElementById('table').children[1];
    let addButton=form.lastElementChild.previousElementSibling;

    await storeApp.readJson();

    addButton.addEventListener('click',(event)=>{
        event.preventDefault();
        let id=document.getElementById('id').value;
        let name=document.getElementById('name').value;
        let price= document.getElementById('price').value;
        let units= document.getElementById('units').value;

        if (!form.checkValidity()){
            let inputs=document.getElementsByTagName('input');
            for (let i = 0; i &lt; inputs.length-2; i++) {
                inputs[i].setCustomValidity("");
                inputs[i].addEventListener('change',inputValidity);
                let div=document.createElement('div');
                div.classList.add('red');
                
                if(inputs[i].validity.patternMismatch){
                    inputs[i].setCustomValidity('El valor introducido no cumple con lo pedido.');
                }
                if(inputs[i].validity.valueMissing){
                    inputs[i].setCustomValidity('El campo es obligatorio.');
                }
                if(inputs[i].validity.tooShort){
                    inputs[i].setCustomValidity('Debes introducir al menos '+inputs[i].minLength+' caracteres.');
                }
                if(inputs[i].validity.tooLong){
                    inputs[i].setCustomValidity('Debes introducir como máximo '+inputs[i].maxLength+' caracteres.');
                }
                if(inputs[i].validity.rangeUnderflow){
                    inputs[i].setCustomValidity('El valor mínimo es '+inputs[i].min);
                }
                if(inputs[i].validity.rangeOverflow){
                    inputs[i].setCustomValidity('El valor máximo es '+inputs[i].max);
                }
                if(!inputs[i].checkValidity()){
                    inputs[i].classList.add('redBorder');
                    div.textContent=inputs[i].validationMessage;
                }

                if(!inputs[i].nextElementSibling.classList.contains('red')){
                    inputs[i].after(div);
                }else{
                    inputs[i].classList.remove('redBorder');
                    div.textContent="";
                }
            }
        }else{
            if(addButton.value=="Añadir"){
                storeApp.addProductToStore(id, name,price,units);
            }else{
            storeApp.changeProductInStore(id,name,price,units);
            document.getElementById('id').disabled=false;
            addButton.value='Añadir';
            }
            form.reset();
        }

    });

    let stockButtonPlus=document.getElementsByName("up");
        for (let i = 0; i &lt; stockButtonPlus.length; i++) {
            stockButtonPlus[i].addEventListener('click',(e)=>{
            e.preventDefault();
            let fila=stockButtonPlus[i].closest('tr');
            let id=fila.querySelector('.idTable').textContent;
            let uds= Number (fila.querySelector('.idUds').textContent);
            let maxUnits= Number (document.getElementById('units').max);
            if(uds&lt;maxUnits){
                storeApp.changeProductStock(id,'plus');
            }else{
                storeApp.sendErrorMessage('Se ha alcanzado el valor máximo de unidades.');
            }
            });
        }

        let stockButtonMinus=document.getElementsByName("down");
        for (let i = 0; i &lt; stockButtonMinus.length; i++) {
            stockButtonMinus[i].addEventListener('click',(e)=>{
                e.preventDefault();
            let fila=stockButtonMinus[i].closest('tr');
            let id=fila.querySelector('.idTable').textContent;
            storeApp.changeProductStock(id,'minus');
            });
        }

    let editButton=document.getElementsByName("pen");
        for (let i = 0; i &lt; editButton.length; i++) {
            editButton[i].addEventListener('click',()=>{
            let fila=editButton[i].closest('tr');
            let id=fila.querySelector('.idTable').textContent;
            document.getElementById('id').disabled=true;
            addButton.value='Cambiar';
            document.getElementById('id').value=id;
            document.getElementById('name').value=fila.children[1].textContent;
            document.getElementById('price').value=fila.children[3].textContent;
            document.getElementById('units').value=fila.children[2].textContent;
            
            let resetButton=form.lastElementChild;
            resetButton.addEventListener('click',(event)=>{
                event.preventDefault();
                document.getElementById('id').value=id;
                document.getElementById('name').value=fila.children[1].textContent;
                document.getElementById('price').value=fila.children[3].textContent;
                document.getElementById('units').value=fila.children[2].textContent;
            });
            });
        }

    let delButtons=document.querySelectorAll('i[name="x"]');
        for (let i = 0; i &lt; delButtons.length; i++) {
            delButtons[i].addEventListener('click',()=>{
            let fila=delButtons[i].closest('tr');
            let id=fila.querySelector('.idTable').textContent;
            storeApp.deleteProductFromStore(id);
            }); 
        }


    function inputValidity(e){
        if(!e.target.checkValidity()){
            e.target.setCustomValidity("");
            if(e.target.validity.patternMismatch){
                e.target.setCustomValidity('El valor introducido no cumple con lo pedido.');
            }
            if(e.target.validity.valueMissing){
                e.target.setCustomValidity('El campo es obligatorio.');
            }
            if(e.target.validity.tooShort){
                e.target.setCustomValidity('Debes introducir al menos '+e.target.minLength+' caracteres.');
            }
            if(e.target.validity.tooLong){
                e.target.setCustomValidity('Debes introducir como máximo '+e.target.maxLength+' caracteres.');
            }
            if(e.target.validity.rangeUnderflow){
                e.target.setCustomValidity('El valor mínimo es '+e.target.min);
            }
            if(e.target.validity.rangeOverflow){
                e.target.setCustomValidity('El valor máximo es '+e.target.max);
            }
            e.target.nextElementSibling.textContent=e.target.validationMessage;
            
        }else{
            e.target.classList.remove('redBorder');
            e.target.nextElementSibling.textContent="";
        }
        
    }

}

/**
 * Ejecuta la inicialización de la aplicación cuando la ventana ha cargado.
 */
window.onload=async function(){
  await init();
    
}




</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Controller.html">Controller</a></li><li><a href="Product.html">Product</a></li><li><a href="Store_Store.html">Store</a></li><li><a href="View.html">View</a></li></ul><h3>Global</h3><ul><li><a href="global.html#init">init</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.5</a> on Mon Dec 15 2025 18:18:28 GMT+0100 (hora estándar de Europa central)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
